CVE-2010-1648:Cross-site request forgery (CSRF)

https://bugzilla.wikimedia.org/show_bug.cgi?id=23371
http://www.mediawiki.org/wiki/Special:Code/MediaWiki/65760

vulnerability in the login interface in MediaWiki 1.15 before 1.15.4 and 1.16
before 1.16 beta 3 allows remote attackers to hijack the authentication of users
for requests that (1) create accounts or (2) reset passwords, related to the
Special:Userlogin form. 

-----
The Special:Userlogin forms for login and account creating is not token 
protected with a session, which caused bug 23076. However, r64677 only 
fixed it for login (which is the most critical due to $wgAllowUserJs).

The hole remains for "E-mail me my password", "Create account" and 
"Create by e-mail", with the following abuse cases:

*For wikis allowing public account creation, an attacker could create 
many accounts via proxying users, avoiding ip blocks, the anon gets 
logged in (wikis using ConfirmEdit to request a captcha for createaccount 
are protected from this).

*If the victims were logged users, the attacker could create the 
accounts by email and flood innocent parties using the wiki as gateway.

*If the victim was a sysop, the attacker could not only bypass the 
captcha protection, but also the username blacklist.

*It also provides a way to bypass the blocks and ping limit for sending 
many password resets flooding its targets.

*On private wikis an account creation by targeting a sysop may expose 
confidential information.

----
1.login as admin/admin1234 
  http://localhost:8888/index.php/Special:UserLogin
2.open xsrf.html
  - will create alice2 user under admin's permission (token)
  - if you install captcha, attacker could bypass with admin's privilege
  