#! /usr/bin/python

import os
import sys

verbose = "-v" in sys.argv
debug = "-d" in sys.argv

def clear(f) :
    # open file
    out = open(f + "_tmp", "w")
    for l in open(f) :
        if l.find(sys.argv[-1]) >= 0 :
            if verbose :
                print "Deleted : %s" % l.rstrip()
            # delete
            continue
        out.write(l)
    
    out.close()
    os.system("mv -f %s_tmp %s" % (f,f))
    
for root, dirs, files in os.walk( "/var/log") :
    for f in [root + "/" + f for f in files] :
        # skip now
        if f.endswith(".gz") :
            continue

        if debug :
            for l in open(f) :
                if l.find(sys.argv[-1]) >= 0 :
                    print l,
        else :
            clear(f)
